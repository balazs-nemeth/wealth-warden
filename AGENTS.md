# AGENTS

This file provides guidance to AI coding agents like Claude Code (claude.ai/code), Cursor AI, Codex, Gemini CLI, GitHub Copilot, and other AI coding assistants when working with code in this repository.

## Project Overview

This is a frontend application that uses React 18 with TypeScript.

## Commands

### Development

| Command  | Purpose                       |
| -------- | ----------------------------- |
| `npm run | Start dev server (hot reload) |

### Testing & Quality

| Command           | Purpose                |
| ----------------- | ---------------------- |
| `npm run lint`    | Run ESLint             |
| `npm run test:ui` | Run UI component tests |

## Architecture

```
ui/
├── main.tsx              # App entry point, sets up AppRoot + BrowserRouter
├── app/
│   ├── App.tsx           # Main layout with Page component and Routes
│   ├── components/       # Reusable UI components
│   ├── hooks/            # Custom React hooks
│   ├── pages/            # Route page components
│   ├── types/            # TypeScript type definitions
│   └── utils/            # Utility functions
└── assets/               # Static assets (images)
api/
└── types/                # Shared API type definitions
```

## Configuration

- `app.config.json` - App metadata
- `tsconfig.eslint.json` - TypeScript config for ESLint
- `ui/tsconfig.json` - TypeScript config for UI code

## Quality Standards

### Logging Standards

#### Prefix Pattern

All logs MUST use a consistent prefix: `[ComponentName]` (e.g., `[BlogFeed]`)

#### Required Logging Elements

1. **Function Entry**: Log timestamp and separator at start

   ```typescript
   console.log(
     "[InvestmentStoryFeed] ========================================"
   );
   console.log(
     "[InvestmentStoryFeed] Function called at",
     new Date().toISOString()
   );
   console.log(
     "[InvestmentStoryFeed] ========================================"
   );
   ```

2. **Numbered Steps**: Log each major operation step

   ```typescript
   console.log("[InvestmentStoryFeed] Step 1: Validating input...");
   console.log("[InvestmentStoryFeed] ✓ Input validated");
   ```

3. **Timing Metrics**: Always log duration for performance analysis

   ```typescript
   const startTime = Date.now();
   // ... operation ...
   const duration = Date.now() - startTime;
   console.log("[InvestmentStoryFeed] Operation completed in", duration, "ms");
   ```

4. **Error Details**: Log comprehensive error information

   ```typescript
   console.error("[InvestmentStoryFeed] Error type:", error.constructor.name);
   console.error("[InvestmentStoryFeed] Error message:", error.message);
   console.error("[InvestmentStoryFeed] Error stack:", error.stack);
   console.error(
     "[InvestmentStoryFeed] Duration before error:",
     duration,
     "ms"
   );
   ```

5. **Success Summary**: Log completion with timing breakdown
   ```typescript
   console.log("[InvestmentStoryFeed] SUCCESS: Operation completed");
   console.log("[InvestmentStoryFeed] Total duration:", duration, "ms");
   ```

#### Security: Never Log

- API keys, tokens, passwords
- PII (Personal Identifiable Information)
- Full URLs with embedded credentials

### Test Coverage Requirements

| Code Type                                | Minimum Coverage |
| ---------------------------------------- | ---------------- |
| Serverless functions with business logic | 80%              |
| UI components                            | 70%              |
| Utility/helper functions                 | 90%              |

### QA Validation Checklist

Before marking a story as **Done**, ensure:

1. **Tests pass**: `npm run test:api` executes without failures
2. **Build succeeds**: `npm run build` completes without errors
3. **Lint passes**: `npm run lint` on `ui/` directory passes
4. **Coverage met**: Test coverage meets or exceeds targets above
5. **All ACs tested**: Each Acceptance Criteria has corresponding test coverage
6. **Edge cases covered**: Error handling, boundary conditions, and failure scenarios are tested

### Test File Locations

| Test Type               | Location                    | Command           |
| ----------------------- | --------------------------- | ----------------- |
| UI component/hook tests | `ui/app/**/*.test.{ts,tsx}` | `npm run test:ui` |

## Agent Tools

### PROJECT_MAP.txt

The `PROJECT_MAP.txt` file is a grep-friendly index of the codebase generated by `agent-tools/architecture-overview.py`. It uses a pipe-delimited format for easy parsing.

#### Format Reference

```
TYPE|field1|field2|field3|field4
```

| Record Type | Format                                    | Description                                          |
| ----------- | ----------------------------------------- | ---------------------------------------------------- |
| `FILE`      | `FILE\|path\|size_bytes\|has_tests`       | File entry with size and test coverage flag          |
| `IMPORT`    | `IMPORT\|file\|import_path`               | Import statement in a file                           |
| `EXPORT`    | `EXPORT\|file\|export_name`               | Exported symbol from a file                          |
| `TYPE`      | `TYPE\|file\|name\|kind\|is_exported`     | Type/interface definition (kind: `interface`/`type`) |
| `CLASS`     | `CLASS\|file\|name\|is_exported`          | Class definition                                     |
| `METHOD`    | `METHOD\|file\|class\|name\|is_async`     | Method within a class                                |
| `FUNC`      | `FUNC\|file\|name\|is_async\|is_exported` | Function definition                                  |

#### Common Grep Patterns

```bash
# Find all files in a directory
grep "^FILE|api/" PROJECT_MAP.txt

# Find all exported symbols
grep "^EXPORT|" PROJECT_MAP.txt

# Find all interfaces
grep "^TYPE|.*|interface|" PROJECT_MAP.txt

# Find all async functions
grep "^FUNC|.*|1|" PROJECT_MAP.txt

# Find files with test coverage
grep "^FILE|.*|true$" PROJECT_MAP.txt

# Find files WITHOUT test coverage (excluding test files)
grep "^FILE|" PROJECT_MAP.txt | grep -v "\.test\." | grep "|false$"

# Find all imports of a specific module
grep "^IMPORT|.*|.*blog" PROJECT_MAP.txt

# Find where a specific function is defined
grep "^FUNC|.*|useBlogFeed|" PROJECT_MAP.txt

# Find all exports from a specific file
grep "^EXPORT|ui/app/hooks/useBlogFeed.ts|" PROJECT_MAP.txt

# List all page components
grep "^FILE|ui/app/pages/.*\.tsx|" PROJECT_MAP.txt | grep -v "\.test\."

# Find all hooks
grep "^FILE|ui/app/hooks/.*\.ts|" PROJECT_MAP.txt | grep -v "\.test\."
```

#### Regenerating the Map

```bash
python agent-tools/architecture-overview.py > PROJECT_MAP.txt
```
